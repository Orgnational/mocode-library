[{"_id":"Default-1657678372355","name":"Default","type":"script","creation_date":1657678372356,"expressions":[{"_id":"Exchange-Sn-to-Ln-1659181575904","code":"{\r\n\r\n\tif (app.project.activeItem) {\r\n\r\n\t\tvar project = app.project;\r\n\t\tvar comp = project.activeItem;\r\n\t\tvar layers = comp.layers;\r\n\r\n\t\t// Loop through every layer in the active comp...\r\n\t\tfor (i = 1; i <= layers.length; i++) {\r\n\r\n\t\t\tvar layer = comp.layer(i);\r\n\t\t\tvar layerName = layer.name;\r\n\t\t\tvar layerSourceName = layer.source.name;\r\n\r\n\t\t\t// If layer name doesn't match the sourcename (minus the psd filename and extension)...\r\n\t\t\tif (layerName !== layerSourceName.split('/')[0]) {\r\n\r\n\t\t\t\t/* \r\n\t\t\t\t    Replaces the layername with [empty], which will force AE to use the source name. \r\n\t\t\t\t    Stays in synch with Photoshop...\r\n\t\t\t\t*/\r\n\r\n\t\t\t\t// layer.name = '';\r\n\r\n\t\t\t\t/* \r\n\t\t\t\t    Replaces the current filename with the first half of the source name. \r\n\t\t\t\t    Doesn't stay in synch with Photoshop...\r\n\t\t\t\t*/\r\n\r\n\t\t\t\tlayer.source.name = layerName.split('/')[0];\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}","name":"Exchange-Sn-to-Ln","last_update":1659181584202},{"_id":"_-1700111205832","code":"var selectedLayers = app.project.activeItem.selectedLayers;\r\n\r\nfunction isNullProperty(property) {\r\n\tif (property.numProperties == 0) {\r\n\t\treturn;\r\n\t} else {\r\n\r\n\t\tfor (var i = 1; i <= property.numProperties; i++) {\r\n\t\t\tif (property.property(i).matchName == \"ADBE Vector Graphic - G-Fill\") {\r\n\t\t\t\t// 添加新的渐变描边属性\r\n\t\t\t\tvar strokeProperty = property.addProperty(\"ADBE Vector Graphic - G-Stroke\");\r\n\t\t\t\t// 设置描边属性的选项\r\n\t\t\t\tstrokeProperty.property(\"ADBE Vector Stroke Width\").setValue(1);\r\n\t\t\t\tstrokeProperty.property(\"ADBE Vector Grad Start Pt\").expression = \"thisProperty.propertyGroup(3).content(\\\"ADBE Vector Graphic - G-Fill\\\")(\\\"ADBE Vector Grad Start Pt\\\")\";\r\n\t\t\t\tstrokeProperty.property(\"ADBE Vector Grad End Pt\").expression = \"thisProperty.propertyGroup(3).content(\\\"ADBE Vector Graphic - G-Fill\\\")(\\\"ADBE Vector Grad End Pt\\\")\";\r\n\t\t\t\tstrokeProperty.property(\"ADBE Vector Stroke Dashes\").addProperty(\"ADBE Vector Stroke Dash 1\");\r\n\t\t\t\tstrokeProperty.property(\"ADBE Vector Stroke Dashes\").property(1).setValue(2);\r\n\t\t\t} else {\r\n\t\t\t\tisNullProperty(property.property(i));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}\r\n}\r\n\r\nif (selectedLayers.length > 0) {\r\n\tvar currentLayer = selectedLayers[0]; // 获取第一个选中的图层\r\n\r\n\tisNullProperty(currentLayer.property(\"ADBE Root Vectors Group\"));\r\n\talert(\"添加成功\")\r\n\r\n} else {\r\n\talert(\"没有选中任何图层\");\r\n}","name":"批量添加渐变描边","last_update":1700111212193},{"_id":"_-1700281720832","code":"var selectedLayers = app.project.activeItem.selectedLayers;\n\nfunction isNullProperty(property) {\n\tif (property.numProperties == 0) {\n\t\treturn;\n\t} else {\n\n\t\tfor (var i = 1; i <= property.numProperties; i++) {\n\t\t\tif (property.property(i).matchName == \"ADBE Vector Graphic - G-Fill\") {\n\t\t\t\t// 添加新的渐变描边属性\n\t\t\t\tvar strokeProperty = property.addProperty(\"ADBE Vector Graphic - G-Stroke\");\n\t\t\t\t// 设置描边属性的选项\n\t\t\t\tstrokeProperty.property(\"ADBE Vector Stroke Width\").setValue(1);\n\t\t\t\tstrokeProperty.property(\"ADBE Vector Grad Start Pt\").expression = \"a = thisLayer.sourceRectAtTime().left;b = thisLayer.sourceRectAtTime().top;w = thisLayer.sourceRectAtTime().width; h = thisLayer.sourceRectAtTime().height;[a,b+h/2]-transform.anchorPoint\";\n\t\t\t\tstrokeProperty.property(\"ADBE Vector Grad End Pt\").expression = \"a = thisLayer.sourceRectAtTime().left;b = thisLayer.sourceRectAtTime().top;w = thisLayer.sourceRectAtTime().width; h = thisLayer.sourceRectAtTime().height;[a+w,b+h/2]-transform.anchorPoint\";\n\t\t\t\tstrokeProperty.property(\"ADBE Vector Stroke Dashes\").addProperty(\"ADBE Vector Stroke Dash 1\");\n\t\t\t\tstrokeProperty.property(\"ADBE Vector Stroke Dashes\").property(1).setValue(2);\n\t\t\t} else {\n\t\t\t\tisNullProperty(property.property(i));\n\t\t\t}\n\t\t}\n\n\t}\n}\napp.beginUndoGroup(\"setStroke\");\nif (selectedLayers.length > 0) {\n\tfor (var n = 0; n < selectedLayers.length; n++) {\n\t\tcurrentLayer = selectedLayers[n];\n\t\tisNullProperty(currentLayer.property(\"ADBE Root Vectors Group\"));\n\t}\n\talert(\"添加成功\");\n} else {\n\talert(\"没有选中任何图层\");\n}\napp.endUndoGroup()","name":"批量添加描边且设置渐变","last_update":1700282661792},{"_id":"_-1700553232136","code":"var tar = app.project.activeItem.selectedLayers;\nvar select = tar[0];\nvar frameRate = 1 / app.project.activeItem.frameDuration;\n\nfor (var i = 1; i < tar.length; i++) {\n\tif (!(tar[i] instanceof AVLayer)) {\n\t\tcontinue;\n\t}\n\n\tvar layer = tar[i];\n\tvar layerPosition = layer.property(\"Position\").value;\n\tvar selectPosition = select.property(\"Position\");\n\tvar newTime = select.inPoint + (i - 1) / frameRate;\n\tselectPosition.setValueAtTime(newTime, layerPosition);\n}","name":"逐帧添加属性","last_update":1700555077463}]}]